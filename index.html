<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>登入頁面</title>

  <script>
    var GAS_API_URL = "https://script.google.com/macros/s/AKfycbwpPPGICLHyZgAPN_osfGdKmIaB_V6ruaMa-XjqijNisARHcP3NkMhV1j10bM6VdROCJw/exec";
  </script>

  <style>
    body {
      margin: 0;
      height: 100vh;
      background-color: #111;
      color: #eee;
      font-family: Arial;
      text-align: center;
    }

    .container {
      position: relative;
      top: 50%;
      transform: translateY(-50%);
    }

    input {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
      width: 200px;
    }

    button {
      background-color: #222;
      color: #fff;
      border: 1px solid #444;
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background-color: #333;
    }

    #loading {
      display: none;
      margin-top: 20px;
      font-size: 18px;
    }

    #message {
      margin-top: 20px;
      font-size: 18px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>登入系統</h2>
    <input type="text" id="username" placeholder="帳號"><br>
    <input type="password" id="password" placeholder="密碼"><br>
    <button id="loginBtn">登入</button>

    <div id="loading">Loading...</div>
    <div id="message"></div>
  </div>

  <script>
    var loginBtn = document.getElementById("loginBtn");
    var loading = document.getElementById("loading");
    var message = document.getElementById("message");

    loginBtn.onclick = function() {
      var username = document.getElementById("username").value.trim();
      var password = document.getElementById("password").value.trim();

      if (!username || !password) {
        message.innerText = "請輸入帳號與密碼";
        return;
      }

      // 顯示 loading，禁用按鈕
      loading.style.display = "block";
      loginBtn.disabled = true;
      message.innerText = "";

      // 發送 POST 請求到 GAS
      var xhr = new XMLHttpRequest();
      xhr.open("POST", GAS_API_URL, true);
      xhr.setRequestHeader("Content-Type", "application/json");

      xhr.onload = function() {
        loading.style.display = "none";
        loginBtn.disabled = false;

        try {
          var res = JSON.parse(xhr.responseText);
          if (res.status === "success") {
            message.innerText = "登入成功";
          } else {
            message.innerText = "登入失敗: " + res.message;
          }
        } catch(e) {
          message.innerText = "系統錯誤";
        }
      };

      xhr.onerror = function() {
        loading.style.display = "none";
        loginBtn.disabled = false;
        message.innerText = "無法連線到伺服器";
      };

      xhr.send(JSON.stringify({ username: username, password: password }));
    };
  </script>
</body>
</html>
